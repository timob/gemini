load('gemini.js');

function test_StarSchema() {
    var jsonData = '{"times":[{"time_id":"0","date_time":"1309504080"},{"time_id":"1","date_time":"1309505880"},{"time_id":"2","date_time":"1309507200"},{"time_id":"3","date_time":"1309508100"},{"time_id":"4","date_time":"1309509180"},{"time_id":"5","date_time":"1309503180"},{"time_id":"6","date_time":"1309506780"},{"time_id":"7","date_time":"1309507680"},{"time_id":"8","date_time":"1309509780"},{"time_id":"9","date_time":"1309510380"},{"time_id":"10","date_time":"1309513980"},{"time_id":"11","date_time":"1309517580"},{"time_id":"12","date_time":"1309521180"},{"time_id":"13","date_time":"1309525380"},{"time_id":"14","date_time":"1309528980"},{"time_id":"15","date_time":"1309532580"},{"time_id":"16","date_time":"1309536180"},{"time_id":"17","date_time":"1309539780"},{"time_id":"18","date_time":"1309543380"},{"time_id":"19","date_time":"1309546980"},{"time_id":"20","date_time":"1309504980"},{"time_id":"21","date_time":"1309508580"},{"time_id":"22","date_time":"1309512180"},{"time_id":"23","date_time":"1309515780"},{"time_id":"24","date_time":"1309519380"},{"time_id":"25","date_time":"1309522980"},{"time_id":"26","date_time":"1309527180"},{"time_id":"27","date_time":"1309530780"},{"time_id":"28","date_time":"1309534380"},{"time_id":"29","date_time":"1309537980"},{"time_id":"30","date_time":"1309541580"},{"time_id":"31","date_time":"1309545180"},{"time_id":"32","date_time":"1309548780"},{"time_id":"33","date_time":"1309550580"},{"time_id":"34","date_time":"1309554180"},{"time_id":"35","date_time":"1309557780"},{"time_id":"36","date_time":"1309561380"},{"time_id":"37","date_time":"1309571340"},{"time_id":"38","date_time":"1309574940"},{"time_id":"39","date_time":"1309578540"}],"route_short_names":[{"route_short_name_id":"0","route_short_name":"13"},{"route_short_name_id":"1","route_short_name":"22"},{"route_short_name_id":"2","route_short_name":"23"},{"route_short_name_id":"3","route_short_name":"N3"}],"route_long_names":[{"route_long_name_id":"0","route_long_name":"After Midnight (Karori\/Northland)"},{"route_long_name_id":"1","route_long_name":"Mairangi - Wellington"},{"route_long_name_id":"2","route_long_name":"Mairangi - Wellington - Houghton Bay"},{"route_long_name_id":"3","route_long_name":"Mairangi - Wellington - Houghton Bay\/Southgate"}],"destinations":[{"destination_id":"0","destination":"Courtenay Place - Blair Street"},{"destination_id":"1","destination":"Houghton Bay - Houghton Bay Road"},{"destination_id":"2","destination":"Island Bay - Dover Street"},{"destination_id":"3","destination":"Northland Tunnel (near Putnam St)"}],"trip_headsigns":[],"time_trip_fact":[{"time_id":"0","route_short_name_id":"0","route_long_name_id":"1","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"1","route_short_name_id":"0","route_long_name_id":"1","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"2","route_short_name_id":"0","route_long_name_id":"1","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"3","route_short_name_id":"0","route_long_name_id":"1","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"4","route_short_name_id":"0","route_long_name_id":"1","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"5","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"6","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"7","route_short_name_id":"1","route_long_name_id":"2","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"8","route_short_name_id":"1","route_long_name_id":"2","destination_id":"0","trip_headsign_id":"-1"},{"time_id":"9","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"10","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"11","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"12","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"13","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"14","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"15","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"16","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"17","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"18","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"19","route_short_name_id":"1","route_long_name_id":"2","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"20","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"21","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"22","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"23","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"24","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"25","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"26","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"27","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"28","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"29","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"30","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"31","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"32","route_short_name_id":"2","route_long_name_id":"3","destination_id":"1","trip_headsign_id":"-1"},{"time_id":"33","route_short_name_id":"2","route_long_name_id":"3","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"34","route_short_name_id":"2","route_long_name_id":"3","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"35","route_short_name_id":"2","route_long_name_id":"3","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"36","route_short_name_id":"2","route_long_name_id":"3","destination_id":"2","trip_headsign_id":"-1"},{"time_id":"37","route_short_name_id":"3","route_long_name_id":"0","destination_id":"3","trip_headsign_id":"-1"},{"time_id":"38","route_short_name_id":"3","route_long_name_id":"0","destination_id":"3","trip_headsign_id":"-1"},{"time_id":"39","route_short_name_id":"3","route_long_name_id":"0","destination_id":"3","trip_headsign_id":"-1"}]}';

    eval('var jsonObject = ' + jsonData);

    var timesDb = new StarSchema(jsonObject, 'time_trip_fact', 'times',
                                'route_short_names', 'route_long_names',
                                'destinations', 'trip_headsigns');

    function filter(route_long_name_id, time_id) {
       if (this["route_long_names"][route_long_name_id].route_long_name.match(/After/))
       { return false }
       return true;
    }    

    selectedRouteLongNames = timesDb.slicendice("route_long_names, times", filter);
    
    for(var i = 0; i < selectedRouteLongNames.length; i++) {
        print(selectedRouteLongNames[i].value.route_long_name);
        var times = selectedRouteLongNames[i].subGroup;
        for(var j = 0; j < times.length; j++) {
            print(" " + new Date(times[j].value.date_time *1000));
        }
    }

//    var jsonData2 =  '{"nearby_stops_with_arrivals":[],"route_short_names":[],"route_long_names":[],"destinations":[],"trip_headsigns":[],"stop_service_fact":[]}';
    var jsonData2 = '{"nearby_stops_with_arrivals":[{"nearby_stops_with_arrival_id":"0","stop_id":"22173","stop_name":"Northland Village - Northland Road (Hell Pizza)","stop_lat":"-41.28321600","stop_lon":"174.75743300"},{"nearby_stops_with_arrival_id":"1","stop_id":"22211","stop_name":"Northland Village - Northland Road","stop_lat":"-41.28340400","stop_lon":"174.75755800"},{"nearby_stops_with_arrival_id":"2","stop_id":"22210","stop_name":"Northland Road (near 88)","stop_lat":"-41.28165100","stop_lon":"174.75908700"},{"nearby_stops_with_arrival_id":"3","stop_id":"22174","stop_name":"Northland Road (near 87)","stop_lat":"-41.28151100","stop_lon":"174.75884400"},{"nearby_stops_with_arrival_id":"4","stop_id":"22212","stop_name":"Northland Tunnel (near Putnam St)","stop_lat":"-41.28488000","stop_lon":"174.75519700"},{"nearby_stops_with_arrival_id":"5","stop_id":"22172","stop_name":"Northland Tunnel (opposite Putnam St)","stop_lat":"-41.28486700","stop_lon":"174.75491000"},{"nearby_stops_with_arrival_id":"6","stop_id":"11596","stop_name":"Glenmore Street at The Rigi (near 147)","stop_lat":"-41.28554100","stop_lon":"174.75914300"},{"nearby_stops_with_arrival_id":"7","stop_id":"11666","stop_name":"Glenmore Street at The Rigi","stop_lat":"-41.28585100","stop_lon":"174.75828000"},{"nearby_stops_with_arrival_id":"8","stop_id":"11667","stop_name":"Glenmore Street at Orangi Kaupapa Rd (near 108)","stop_lat":"-41.28356200","stop_lon":"174.76192000"},{"nearby_stops_with_arrival_id":"9","stop_id":"22171","stop_name":"Karori Sanctuary - Northland Tunnel Road","stop_lat":"-41.28609500","stop_lon":"174.75471600"},{"nearby_stops_with_arrival_id":"10","stop_id":"11647","stop_name":"Chaytor Street at Curtis Street","stop_lat":"-41.28446300","stop_lon":"174.75302500"},{"nearby_stops_with_arrival_id":"11","stop_id":"11601","stop_name":"Chaytor Street at Curtis Street (opposite)","stop_lat":"-41.28458100","stop_lon":"174.75293200"},{"nearby_stops_with_arrival_id":"12","stop_id":"11595","stop_name":"Glenmore Street at Orangi Kaupapa Rd","stop_lat":"-41.28357700","stop_lon":"174.76213500"},{"nearby_stops_with_arrival_id":"13","stop_id":"11600","stop_name":"Karori Sanctuary - Chaytor Street (Appleton Pa","stop_lat":"-41.28621700","stop_lon":"174.75437300"},{"nearby_stops_with_arrival_id":"14","stop_id":"11649","stop_name":"Glenmore Street at Northland Road","stop_lat":"-41.28700800","stop_lon":"174.75684200"},{"nearby_stops_with_arrival_id":"15","stop_id":"11646","stop_name":"Chaytor Street at Joll Street (opposite)","stop_lat":"-41.28262700","stop_lon":"174.75236700"},{"nearby_stops_with_arrival_id":"16","stop_id":"11602","stop_name":"Chaytor Street at Joll Street","stop_lat":"-41.28301000","stop_lon":"174.75199500"},{"nearby_stops_with_arrival_id":"17","stop_id":"11648","stop_name":"Karori Sanctuary - Chaytor Street (at Tunnel)","stop_lat":"-41.28708300","stop_lon":"174.75489700"},{"nearby_stops_with_arrival_id":"18","stop_id":"22207","stop_name":"Northland Road at Military Road","stop_lat":"-41.27952800","stop_lon":"174.76010500"},{"nearby_stops_with_arrival_id":"19","stop_id":"22175","stop_name":"Northland Road at Kaihuia Street (near 127)","stop_lat":"-41.27932900","stop_lon":"174.75958600"},{"nearby_stops_with_arrival_id":"20","stop_id":"11635","stop_name":"Karori Sanctuary - Birdwood Street","stop_lat":"-41.28677900","stop_lon":"174.75413700"},{"nearby_stops_with_arrival_id":"21","stop_id":"11599","stop_name":"Glenmore Street at Karori Tunnel","stop_lat":"-41.28758200","stop_lon":"174.75639100"},{"nearby_stops_with_arrival_id":"22","stop_id":"11668","stop_name":"Glenmore Street at Garden Road","stop_lat":"-41.28244400","stop_lon":"174.76321500"},{"nearby_stops_with_arrival_id":"23","stop_id":"11597","stop_name":"Glenmore Street at Kelburn Viaduct (near 177)","stop_lat":"-41.28781300","stop_lon":"174.75780600"},{"nearby_stops_with_arrival_id":"24","stop_id":"11665","stop_name":"Glenmore Street at Kelburn Viaduct","stop_lat":"-41.28786900","stop_lon":"174.75765300"},{"nearby_stops_with_arrival_id":"25","stop_id":"11664","stop_name":"Kelburn Normal School - Upland Road (opposite)","stop_lat":"-41.28718300","stop_lon":"174.76072700"},{"nearby_stops_with_arrival_id":"26","stop_id":"22349","stop_name":"Raroa Road (near 1)","stop_lat":"-41.28783900","stop_lon":"174.75606400"},{"nearby_stops_with_arrival_id":"27","stop_id":"11650","stop_name":"Kelburn Normal School - Upland Road","stop_lat":"-41.28712600","stop_lon":"174.76091700"},{"nearby_stops_with_arrival_id":"28","stop_id":"22206","stop_name":"Northland Road at Seaview Terrace (near 138)","stop_lat":"-41.27953500","stop_lon":"174.76139400"},{"nearby_stops_with_arrival_id":"29","stop_id":"22176","stop_name":"Northland Road at Pembroke Road (near 141)","stop_lat":"-41.27941200","stop_lon":"174.76118800"},{"nearby_stops_with_arrival_id":"30","stop_id":"22333","stop_name":"Raroa Road (near 4)","stop_lat":"-41.28796800","stop_lon":"174.75591200"},{"nearby_stops_with_arrival_id":"31","stop_id":"11634","stop_name":"Birdwood Street at Braithwaite Street (near 1)","stop_lat":"-41.28381900","stop_lon":"174.75094200"},{"nearby_stops_with_arrival_id":"32","stop_id":"11636","stop_name":"Birdwood Street at Braithwaite Street","stop_lat":"-41.28417000","stop_lon":"174.75092700"},{"nearby_stops_with_arrival_id":"33","stop_id":"22348","stop_name":"Moana Road (near 18)","stop_lat":"-41.28812200","stop_lon":"174.75465000"},{"nearby_stops_with_arrival_id":"34","stop_id":"22334","stop_name":"Moana Road (near 15)","stop_lat":"-41.28828500","stop_lon":"174.75515600"},{"nearby_stops_with_arrival_id":"35","stop_id":"11598","stop_name":"Glenmore Street (near 205)","stop_lat":"-41.28854500","stop_lon":"174.75705000"},{"nearby_stops_with_arrival_id":"36","stop_id":"22351","stop_name":"Plunket Street (near 24)","stop_lat":"-41.28841800","stop_lon":"174.76007900"},{"nearby_stops_with_arrival_id":"37","stop_id":"11603","stop_name":"Karori Road at Standen Street (near 93)","stop_lat":"-41.28146800","stop_lon":"174.75033000"},{"nearby_stops_with_arrival_id":"38","stop_id":"11645","stop_name":"Karori Road at Standen Street (near 90)","stop_lat":"-41.28130800","stop_lon":"174.75025400"},{"nearby_stops_with_arrival_id":"39","stop_id":"22330","stop_name":"Plunket Street (opposite 20)","stop_lat":"-41.28868400","stop_lon":"174.76032500"}],"route_short_names":[{"route_short_name_id":"0","route_short_name":"13"},{"route_short_name_id":"1","route_short_name":"17"},{"route_short_name_id":"2","route_short_name":"18"},{"route_short_name_id":"3","route_short_name":"20"},{"route_short_name_id":"4","route_short_name":"21"},{"route_short_name_id":"5","route_short_name":"22"},{"route_short_name_id":"6","route_short_name":"23"},{"route_short_name_id":"7","route_short_name":"3"},{"route_short_name_id":"8","route_short_name":"47"}],"route_long_names":[{"route_long_name_id":"0","route_long_name":"Campus Connection (Karori - Miramar)"},{"route_long_name_id":"1","route_long_name":"Campus Connection (Miramar - Karori)"},{"route_long_name_id":"2","route_long_name":"Highbury - Wellington - Mt Victoria"},{"route_long_name_id":"3","route_long_name":"Houghton Bay - Wellington - Mairangi"},{"route_long_name_id":"4","route_long_name":"Johnsonville to Newtown"},{"route_long_name_id":"5","route_long_name":"Karori - Wellington"},{"route_long_name_id":"6","route_long_name":"Karori - Wellington - Vogeltown"},{"route_long_name_id":"7","route_long_name":"Mairangi - Wellington - Houghton Bay"},{"route_long_name_id":"8","route_long_name":"Mairangi - Wellington - Houghton Bay\/Southgate"},{"route_long_name_id":"9","route_long_name":"Mt Victoria - Wellington - Highbury"},{"route_long_name_id":"10","route_long_name":"Newtown to Johnsonville"},{"route_long_name_id":"11","route_long_name":"Southgate - Wellington - Mairangi"},{"route_long_name_id":"12","route_long_name":"The Green Route (Karori - Wellington - Lyall Bay)"},{"route_long_name_id":"13","route_long_name":"The Green Route (Lyall Bay - Wellington - Karori)"},{"route_long_name_id":"14","route_long_name":"Vogeltown - Wellington - Karori"},{"route_long_name_id":"15","route_long_name":"Wellington - Karori"},{"route_long_name_id":"16","route_long_name":"Wellington - Mairangi"}],"destinations":[{"destination_id":"0","destination":"Courtenay Place - Blair Street"},{"destination_id":"1","destination":"Farnham Street at Balfour Street"},{"destination_id":"2","destination":"Highbury Terminus"},{"destination_id":"3","destination":"Houghton Bay - Houghton Bay Road"},{"destination_id":"4","destination":"Island Bay - Dover Street"},{"destination_id":"5","destination":"Johnsonville Station - Stop A"},{"destination_id":"6","destination":"Karori Mall - Beauchamp St (Recreation Centre)"},{"destination_id":"7","destination":"Karori Park"},{"destination_id":"8","destination":"Karori West - Montgomery Avenue"},{"destination_id":"9","destination":"Kilbirnie Shops - Rongotai Road (Kilbirnie Sport"},{"destination_id":"10","destination":"Lyall Bay - Hungerford Road"},{"destination_id":"11","destination":"Mairangi - Norwich Street"},{"destination_id":"12","destination":"Miramar - Darlington Road"},{"destination_id":"13","destination":"Mt Victoria Terminus"},{"destination_id":"14","destination":"National Dance and Drama Centre - Stop B"},{"destination_id":"15","destination":"South Karori - Hazelwood Avenue (near 89)"},{"destination_id":"16","destination":"Wellington Station - Stop V"}],"trip_headsigns":[],"stop_service_fact":[{"nearby_stops_with_arrival_id":"7","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"8","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"10","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"15","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"22","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"24","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"38","route_short_name_id":"7","route_long_name_id":"12","destination_id":"10","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"7","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"8","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"10","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"15","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"22","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"24","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"38","route_short_name_id":"7","route_long_name_id":"12","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"6","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"11","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"12","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"13","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"16","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"23","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"35","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"37","route_short_name_id":"7","route_long_name_id":"13","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"0","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"3","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"5","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"6","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"9","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"12","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"19","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"23","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"29","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"35","route_short_name_id":"0","route_long_name_id":"16","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"10","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"15","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"38","route_short_name_id":"1","route_long_name_id":"5","destination_id":"16","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"11","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"13","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"16","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"25","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"37","route_short_name_id":"1","route_long_name_id":"15","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"20","route_short_name_id":"2","route_long_name_id":"1","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"2","route_long_name_id":"1","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"25","route_short_name_id":"2","route_long_name_id":"1","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"32","route_short_name_id":"2","route_long_name_id":"1","destination_id":"7","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"2","route_long_name_id":"0","destination_id":"12","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"2","route_long_name_id":"0","destination_id":"12","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"2","route_long_name_id":"0","destination_id":"12","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"31","route_short_name_id":"2","route_long_name_id":"0","destination_id":"12","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"2","route_long_name_id":"0","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"2","route_long_name_id":"0","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"2","route_long_name_id":"0","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"31","route_short_name_id":"2","route_long_name_id":"0","destination_id":"9","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"36","route_short_name_id":"3","route_long_name_id":"2","destination_id":"13","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"26","route_short_name_id":"3","route_long_name_id":"2","destination_id":"13","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"33","route_short_name_id":"3","route_long_name_id":"2","destination_id":"13","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"30","route_short_name_id":"3","route_long_name_id":"9","destination_id":"2","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"34","route_short_name_id":"3","route_long_name_id":"9","destination_id":"2","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"39","route_short_name_id":"3","route_long_name_id":"9","destination_id":"2","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"6","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"12","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"20","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"23","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"32","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"35","route_short_name_id":"4","route_long_name_id":"14","destination_id":"6","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"7","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"8","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"22","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"24","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"31","route_short_name_id":"4","route_long_name_id":"6","destination_id":"1","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"7","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"8","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"22","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"24","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"31","route_short_name_id":"4","route_long_name_id":"6","destination_id":"0","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"0","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"3","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"5","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"9","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"19","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"25","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"29","route_short_name_id":"5","route_long_name_id":"3","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"1","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"2","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"4","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"18","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"28","route_short_name_id":"5","route_long_name_id":"7","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"0","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"3","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"5","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"9","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"19","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"25","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"29","route_short_name_id":"6","route_long_name_id":"11","destination_id":"11","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"1","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"2","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"4","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"18","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"28","route_short_name_id":"6","route_long_name_id":"8","destination_id":"3","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"1","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"2","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"4","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"18","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"28","route_short_name_id":"6","route_long_name_id":"8","destination_id":"4","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"6","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"11","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"12","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"13","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"16","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"23","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"35","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"37","route_short_name_id":"7","route_long_name_id":"13","destination_id":"15","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"14","route_short_name_id":"8","route_long_name_id":"4","destination_id":"14","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"17","route_short_name_id":"8","route_long_name_id":"4","destination_id":"14","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"27","route_short_name_id":"8","route_long_name_id":"4","destination_id":"14","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"13","route_short_name_id":"8","route_long_name_id":"10","destination_id":"5","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"8","route_long_name_id":"10","destination_id":"5","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"25","route_short_name_id":"8","route_long_name_id":"10","destination_id":"5","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"6","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"11","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"12","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"13","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"16","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"21","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"23","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"35","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"},{"nearby_stops_with_arrival_id":"37","route_short_name_id":"7","route_long_name_id":"13","destination_id":"8","trip_headsign_id":"-1"}]}';
    eval('jsonObject = ' + jsonData2);

    var stopDB = new StarSchema(jsonObject, "stop_service_fact",
                                "nearby_stops_with_arrivals",
                                "route_short_names",
                                "route_long_names",
                                "destinations",
                                "trip_headsigns");
    
                                
    var stops = stopDB.slicendice("nearby_stops_with_arrivals, route_short_names, route_long_names", null);
 
    stopDB.add_alias("route_long_names", "route_long_name", "myalias");
 
    for (var i = 0; i < stops.length; i++) {
        var route_short_names = stops[i].subGroup;
        for (var j = 0; j < route_short_names.length; j++) {
            var route_long_names = route_short_names[j].subGroup;
            for (var k = 0; k < route_long_names.length; k++) {
//                print(route_long_names[k].value.route_long_name);
                print(stops[i].value.stop_name + ' | ' + route_short_names[j].value.route_short_name + ' | ' + route_long_names[k].value.myalias);
            }
        }                        
    }                                                 
    
    print("finished tests");    
}

function perf_gemini() {
    load('./data');

    eval('var jsonObject = ' + jsonData);
    db = new StarSchema(jsonObject,
                          'all_route_fact',
                          'route_short_names',
                          'route_ids',
                          'route_long_names',
                          'route_types',
                          'route_colors',
                          'route_text_colors',
                          'trip_headsigns',
                          'direction_ids',
                          'destinations');

    var routes = db.slicendice('route_short_names, route_long_names, route_types', null);

    for (var i = 0; i < routes.length; i++) {
        var details = new Array();
        for (var j = 0; j < routes[i].subGroup.length; j++) {
            details.push(routes[i].subGroup[j].value.route_long_name);
        }
        print(routes[i].value.route_short_name + ' ' + details.join(' '));
    }

}

perf_gemini();
